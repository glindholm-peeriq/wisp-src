							doswisp.lis
							07/08/93

	MSDOS Implementation of WISP with ACUCOBOL 386
	==============================================

Requirments:

	MSDOS Version 5.0
	ACUCOBOL EXTENDED MSDOS 386 Version 2.1.1
	Intel C Code Builder Version 1.0e (for user added C subroutines)
	386/486, 4meg memory, 10meg disk (Plus applications)
	VGA + color monitor

	NOTES:
	- Only the ACUCOBOL EXTENDED MSDOS 386 is supported not the
		regular ACUCOBOL for MSDOS.
	- Currently only Version 1.0e of Code Builder is supported. The
		later version (1.1a) has a bug which makes it unsupported
		for ACUCOBOL.


Setting Up Runtime System:
		
	Environment variables
	---------------------
	SET WISPCONFIG=C:\WISP\CONFIG
	SET HOME=C:\HOME
	SET USER=MyName
	SET A_CONFIG=%WISPCONFIG%\ACUCOBOL.CFG

	(Optional)
	SET TTY=CON:
	SET WISPTERM=MyTerm
	SET VIDEOCAP=C:\VIDEOCAP
	SET WISPDEBUG=FULL
	SET RUNCBL=MyRuntime
	SET VCOLORS=colorhexcodes
	SET WEDITOR=MyEditor

	NOTES:
	- WISPCONFIG must be set.
	- HOME will default to C:\ if not set.
	- USER will default to USER if not set. This is how you set a
		userid.  If on a network the first 3 chars must be unique.
	- ACUCOBOL.CFG: we called it  ACUCONFIG on unix and Acucobol
		calls it CBLCONFI.
	- TTY is used to identify the device, and lookup the device number 
		in WSYSCONF.CFG.  If not set it defaults to CON: (console).
		Usually will only need to set if on a network.
	- WISPTERM, VIDEOCAP, WISPDEBUG, RUNCBL behave same as unix.
	- VCOLORS allows you to load the color attributes table (see below)
	- WEDITOR the editor to use from Manage Files/Libs (default vsedit)


	Files and directories			(Unix equivalent if diff)
	---------------------
	%WISPCONFIG%
	%WISPCONFIG%\LGMAP
	%WISPCONFIG%\WISPMSG.DAT
	%WISPCONFIG%\WRUN.CFG			$WISPCONFIG/wrunconfig
	%WISPCONFIG%\ACUCOBOL.CFG		$WISPCONFIG/ACUCONFIG
	%WISPCONFIG%\OPTIONS
	%WISPCONFIG%\PRTMAP
	%WISPCONFIG%\DEFAULTS.SYS		$WISPCONFIG/PERSONALITY
	%WISPCONFIG%\WSYSCONF.CFG		$WISPCONFIG/wsysconfig
	%WISPCONFIG%\VIDEOCAP\MSDOS
	%WISPCONFIG%\VIDEOCAP\*

	%HOME%\DEFAULTS.USR			$HOME/PERSONALITY
	%HOME%\WISPERR.LOG

	C:\TMP\WPPARMS
	C:\TMP\RETCOD
	C:\TMP\WLIBLIST
	C:\TMP\DFTS-xxx.TMP			/usr/tmp/PERSONxxxxxxx

	ACUUSING
		
	NOTES:
	- Dir %HOME% must exist.
	- Dir C:\TMP will be created if needed.
	- ACULINK is not used on MSDOS
	- VIDEOCAP\MSDOS is the same as the internal defaults.
	- There is no wsysconf program on MSDOS, a sample WSYSCONF.CFG is
		provided that can be modified.


Terminal and Keyboard:

	MSDOS does not require a Videocap file, it has internal defaults
	that map the keyboard as follows:

	F1 - F12		F1 - F12
	Shift F1- F12		F11 - F22	(Shift  +10)
	Ctrl F1 - F12		F21 - F32	(Ctrl	+20)
	Alt F1,F2		F31, F32	(Alt	+30)
	ESC			HELP
	Home			HELP
	End			PF16
	Page-Up			BACKTAB
	Page-Dn			NEWLINE
	Ctrl-INSERT		Clear_After
	Ctrl-DELETE		Clear_Field
	Shift TAB		BACKTAB

	NOTES:
	- On MSDOS the "Capablities" section of the Videocap file is
		not used.  Screen I/O is done by direct manipulation of
		the video memory, not (as on unix) by sending escape codes 
		to the device. The only "Capablities" used are 
		"pseudo_blanks" and "graphstr".
	- You can set TERM or WISPTERM to a different videocap file to
		change the keyboard mapping.


WISP Translator:

	To translate use WISP the same as on unix. 
	Use the -VACU (default) langauge flag.  
	There has been support added for a @response file.

		C:\> WISP @respfile ...

	Command line options will be read from the respfile. It will
	accept options from both the command line and the response file.
	The full command with all options will be displayed after the
	response file has beed processed.

	Options can be specified with either a "-" (unix style) of "/".

		C:\> WISP -VACU /W words.def @my.rsp sample

	For MSDOS the directory path separator on the "-Idir" option
	is a semicolon ';'.  (On unix it is a colon ':' but this
	conflicts with the MSDOS drive specifier.)

		C:\> WISP -I c:\copy1;c:\copy2;d:\copybook sample

	You may want to use the #CHANGE_STOP_RUN option file option to
	cause WISP to change STOP RUN into EXIT PROGRAM.  You will only
	need this if you have coded STOP RUN statements without
	EXIT PROGRAM statements as a STOP RUN will terminate the
	runtime not just the link-level.

	When translating programs with WISP that are normally started
	with a CALL "LINK" you should use the "-D" options to cause
	the "IS INITIAL" clause to be added to the PROGRAM-ID paragraph.
	This will ensure initial data values each time the program
	is entered.

NOTES:

	LOGOFF does an exit.

	Change STOP RUN to EXIT PROGRAM. (See #CHANGE_STOP_RUN option.)

	The WPUTPARM utility support response files the same as WISP
	the translator.

		C:>\ WPUTPARM @respfile ...
	

Color Attributes Table: (VCOLORS)

	There is a internal video table (attributes[]) which determines
	how display characteristics are mapped to colors. To change
	the default values you can set the environment variable
	called VCOLORS to a replacement hex string.  This string is
	16 bytes (32 hex digits) which represent the 16 supported
	display characteristics in this order:

		0	Normal
		1	Bold
		2	Underscore
		3	Bold + Underscore
		4	Blink
		5	Blink + Bold
		6	Blink + Underscore
		7	Blink + Underscore + Bold
		8	Reverse
		9	Reverse + Bold
		A	Reverse + Underscore
		B	Reverse + Underscore + Bold
		C	Reverse + Blink
		D	Reverse + Blink + Bold
		E	Reverse + Blink + Underscore
		F	Reverse + Blink + Underscore + Bold

	Each byte (2 hex digits) specifies the background color, the
	foreground color and the blink characteristic.

		0.......	Normal character
		1.......	Blinking character
		.xxx....	Background color 0-7
		....xxxx 	Foreground color 0-F

	The colors map as follows:
		0	BLACK		8	GRAY (dark gray)
		1	BLUE		9	LIGHTBLUE
		2	GREEN		A	LIGHTGREEN
		3	CYAN		B	LIGHTCYAN
		4	RED		C	LIGHTRED
		5	MAGENTA		D	LIGHTMAGENTA (pink)
		6	BROWN		E	YELLOW
		7	WHITE (gray)	F	BRIGHTWHITE (white)

	NOTE: The blink and background color combine to form one hex digit.
	NOTE: The "bright" colors are only available as foreground.
	NOTE: MSDOS does NOT provide an UNDERSCORE attribute.

	The default VCOLORS setting would be specified as:

		SET VCOLORS=171F070F979F878F71793139F1F9B1B9

	We provide some sample BAT files that set VCOLORS to different
	color schemes.
		VCYAN.BAT	Cyan with black (& white,red,yellow) 
		VBROWN.BAT	Brown with white (& black) characters
		VWHITE.BAT	White with black (& cyan) characters
		VGREEN.BAT	Green on black
		VRED.BAT	Red on white
		VYELLOW.BAT	Yellow on white
		VPINK.BAT	Pink on white
		VBLUE.BAT	Blue on white


Printing on MS-DOS:

	To use forms and classes you need to setup a PRTMAP file in 
	your $WISPCONFIG directory.  The PRTMAP file supplies WISP with
	the escape codes needed to setup the printer before printing
	the file.

	The following is the sample PRTMAP that comes with your WISP kit.
	It contains some sample escape codes for an HP LASERJET printer.
	You will need to modify this file based on the printers and forms
	you are using.

	#
	#	PRTMAP		MS-DOS PRINTING MAP
	#
	#	PRINTER		Wang style printer number.
	#	CLASS		Wang style print class.
	#	FORM		Wang style form number.
	#	SETUP		Printer setup string to use.
	#	RESET		Printer reset string to use.
	#
	#	This table is searched sequentially for a matching
	#	printer, class, and form number.  An '*' can be used
	#	to wildcard printer, class, and form number.  When
	#	a match is found corresponding setup, and reset will
	#	be used.  The setup string will be sent to the printer 
	#	before you file is printed, and reset string will be
	#	sent after. A '-' can be used to indicate no setup
	#	or reset string.  To include a space, tab or newline
	#	in a string use the control character or octal number.
	#	(Space = \040 Tab = ^I or \011 Newline = ^J or \012)
	#
	#	\E	Escape	\033
	#	\ddd	Octal
	#	\n	Newline
	#	\\	'\'
	#	\"	'"'
	#	^x	Control x	x & 0x1F
	#
	#PRINTER CLASS FORM SETUP     		RESET	COMMENT
	#0         A    000 "\EE\E&l0O" 	"\EE"
	0	   *	000 "\EE\E&l0O" 	"\EE"	Portrait
	0	   *	132 "\EE\E&l1O" 	"\EE"	Landscape
	0	   *	133 "\EE\E&l1O\E&l8D"	"\EE" 	Landscape condensed
	0	   *	088 "\EE\E&l8D" 	"\EE"	Portrait condensed
	0	   *    044 "\EE\E&l4D"		"\EE"	Portrait 4 lpi
	0	   *	*   "\EE"		"\EE"
	1	   *	*   -			-
	#*         *    *   -         		-	(Internal default)

	Printer numbers are used as the MS-DOS printer numbers and must
	be 0,1 or 2.  Any number outside 0-2 range is treated as 0.

		0	LPT1 (PRN)
		1	LPT2
		2	LPT3

	The Wang print mode PRNTMODE is treated as follows:

		S	Print and delete
		P	Print and don't delete
		H	Don't print
		K	Don't print
		O	Not supported



Distribution Kit:

	WISP\BIN\DISPLAY.EXE	
	WISP\BIN\MAKEMSG.EXE
	WISP\BIN\PROCTRAN.EXE
	WISP\BIN\VSEDIT.EXE
	WISP\BIN\VTEST.EXE
	WISP\BIN\WCOPY.EXE
	WISP\BIN\WISP.EXE
	WISP\BIN\WLICENSE.EXE
	WISP\BIN\WPUTPARM.EXE
	WISP\BIN\WRUN.EXE
	WISP\BIN\WSHELL.BAT
	WISP\BIN\WSORT.EXE
	WISP\BIN\WUSAGE.EXE
	WISP\BIN\WRUNCBL.EXE

	WISP\LIB\VIDEO.LIB
	WISP\LIB\WISP.LIB

	WISP\ETC\RELNOTES
	WISP\ETC\DISPRINT.WCB
	WISP\ETC\DISPRINT.MAK
	WISP\ETC\WORDS.DEF
	WISP\ETC\DOSMAKE.MAK

	WISP\ETC\VBLUE.BAT
	WISP\ETC\VBROWN.BAT
	WISP\ETC\VCYAN.BAT
	WISP\ETC\VGREEN.BAT
	WISP\ETC\VPINK.BAT
	WISP\ETC\VRED.BAT
	WISP\ETC\VWHITE.BAT
	WISP\ETC\VYELLOW.BAT

	WISP\CONFIG\LGMAP
	WISP\CONFIG\OPTIONS
	WISP\CONFIG\PRTMAP
	WISP\CONFIG\WISPMSG.DAT
	WISP\CONFIG\WISPMSG.TXT
	WISP\CONFIG\WRUN.CFG
	WISP\CONFIG\WSYSCONF.CFG

	WISP\CONFIG\VIDEOCAP\MSDOS
	WISP\CONFIG\VIDEOCAP\*

	WISP\ACU\ACUDOS.RUL
	WISP\ACU\ACUUSING.COB
	WISP\ACU\SUB85.C
	WISP\ACU\WRUNCBL.MAK

	EDE\GOOD.EXE
	EDE\EDE.LIB
	EDE\WRUNCBLE.EXE
	EDE\DEMO\HELPMAP
	EDE\DEMO\*.WCB
	EDE\DEMO\*.HLP
	EDE\DEMO\MENUDEMO.OPT
	EDE\DEMO\MENUDEMO.MAK


Features Not Implemented:

	MESSAGE, SUBMIT, MOUNT, DISMOUNT
	Cancel-Exit on a LINK
	COBOL RETURN-CODE processing (wretcode)
	vsx, vcapkeys, viewkeys, wdiag

