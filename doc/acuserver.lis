	Copyright (c) 1996 by DevTech Migrations Inc. All Rights Reserved.
	
	====================================================================
	
	Title:		WISP SUPPORT FOR ACUSERVER
	
	Document:	acuserver.lis
	Last Updated:	16 Jan 1996
	Products:	AcuServer, WISP/UNIX
	Versions:	3.3.19 of WISP
			1.1.1 of AcuServer
	
	Summary:	Description of WISP support for the Acucobol
			product AcuServer.

	====================================================================


	OVERVIEW
	========

	This document describes WISP support for the AcuServer.  AcuServer
	is an add-on product available from Acucobol which gives your
	COBOL applications network file access without the performance
	degradation which can occur when using NFS.

		"AcuServer gives COBOL applications remote file access
		 support in client/server environments."

			-- AcuServer Product Brief --

	When you use AcuServer to access remote data files all your COBOL
	applications file I/O goes through the AcuServer mechanism
	(instead of NFS.)  This can significantly improve you file I/O
	performance over that of NFS.


	WISP SUPPORT FOR ACUSERVER
	==========================

	This section describes the issues related to using AcuServer with
	WISP and describes how the WISP support for AcuServer addresses
	these issues.


	Important Note
	--------------
	It is very important that you read the AcuServer User's Guide for
	a full understanding of how to install and configure AcuServer.

	The issues discussed in this document are specific to using
	AcuServer with WISP converted applications.  There are a number of
	general issues/considerations in using AcuServer that are
	discussed in the AcuServer User's Guide.


	Issues Related to AcuServer
	---------------------------
	There are two main areas that need to be addressed in order to use
	AcuServer with WISP converted software.

	1)	AcuServer uses a custom syntax for fully specifying the 
		location of a file which includes a node/machine name.
		This syntax is NOT compatible with normal "C" or UNIX
		file specifications.

		Syntax:		@server-name:path-name

		Example:	@central:/disk1/myvol/mylib/myfile

			In this example the file is "myfile" in directory
			"/disk1/myvol/mylib" which resides on machine
			"central" specified as "@central:".

	2)	There will not be a physical file that is locally
		accessible (local or NFS) through normal "C" or UNIX
		routines.  There are numerous places in the WISP
		environment that attempt to access files.  Most
		importantly these occur in the pre-open logic (wfopen)
		and in the VSSUBS routines.

	Addressing the first issue, custom file path syntax, by itself is
	trivial, one would simply include the server name prefix in the
	LGMAP for the remote files.  This however would fail because of
	the second issue.  Without a locally accessible file (local or
	NFS) many areas of logic would fail, e.g. on an OPEN I-O, WISP
	checks for the existence of the file and if not found issues a
	GETPARM.  Other examples include READFDR, SCRATCH, FIND, RENAME,
	SORTCALL, COPY, etc. all of these expect to find a file and will
	fail if the file is not found.

	It is possible to modify your applications so they simply avoid
	the second issue and WISP can be instructed to bypass normal file
	opening procedures (this is currently done when the OPEN logic
	sees an '@' as the first character of the unix filepath), thus
	leaving only the first issue which is easily solved.  However,
	because we are converting large existing application which are
	peppered with VSSUBS and file references this approach would
	require a huge manual recoding effort.  This approach is thus
	considered impractical.


	AcuServer Support
	-----------------
	The rest of this document describes the method WISP uses to
	provide support for AcuServer which addresses the above issues.

	The essence of the implementation is that two file paths will be
	generated, one for AcuServer which includes the server prefix, and
	a standard unix one for the other routines using the NFS file
	path.

		AcuServer:	@central:/disk1/myvol/mylib/myfile
		Standard:	/central/disk1/myvol/mylib/myfile

	This implementation REQUIRES the use of NFS (or equivalent).  It
	also requires that you be able to distinguish a file that is on an
	NFS mounted file system from a file that is on a local file system
	by a distinct prefix in the file path.  In the example above, the
	prefix "/central/" can be used to indicate that this is an NFS
	file system and the disks belong to machine "central".


	Configuration: LGMAP and RVMAP
	------------------------------
	To configure your WISP converted program to use AcuServer you will
	need to use both the LGMAP (Logical Volume Map) and a new map file
	RVMAP (Remote Volume Map).

	Within the LGMAP you need to define the volumes with NFS style
	names.  This is done exactly the same as you would if you were
	just using NFS without AcuServer.

	LGMAP example:
		VOL200 /central/disk1/myvol	- NFS from "central"
		VOL300 /mnt/dp001/usr/vol300	- NFS from "dp001"
		VOL100 /disk2/vol100		- Local file system

	The RVMAP (Remote Volume Map) is used to create the special
	AcuServer syntax file path from a regular unix file path.  RVMAP
	is a translation table with each line containing two entries:

		Local-file-path-prefix  Remote-substitution-prefix

	The Local-file-path-prefix is the portion of the file path that
	will be replaced with the Remote-substitution-prefix when the
	AcuServer syntax file path is created.

	RVMAP example:
		/central/   @central:/
		/mnt/dp001/ @dp001:/

	The following table demonstrates some file translations to both
	the unix file path and the AcuServer style file path using the
	above example LGMAP and RVMAP.

	VOLUME LIBRARY FILE	Standard UNIX file path
				AcuServer file path
	------ ------- ------   -----------------------------------
	VOL200 MYLIB   MYFILE	/central/disk1/myvol/mylib/myfile
				@central:/disk1/myvol/mylib/myfile

	VOL300 MYLIB   MYFILE	/mnt/dp001/usr/vol300/mylib/myfile
				@dp001:/usr/vol300/mylib/myfile

	VOL100 MYLIB   MYFILE	/disk2/vol100/mylib/myfile
				/disk2/vol100/mylib/myfile


	Configuration: ACUCONFIG ($A_CONFIG)
	------------------------------------
	The AcuServer User's Guide specifies a number of configuration
	options that affect AcuServer operation.  

	It suggests that you set FILE-PREFIX so that it includes paths
	with Remote Name notation and set APPLY-FILE-PATH so that even
	absolute path names are effected.  These suggestions will NOT work
	correctly with WISP converted software.  WISP converted software
	will always generate fully qualified path names for data file so
	the FILE-PREFIX option is not needed and may cause unpredictable
	behaviour if used.

	Do NOT use the FILE-PREFIX and APPLY-FILE-PATH options with WISP
	converted software.

	You may however use the Remote Name notation in the CODE-PREFIX
	and keep your Acucobol object file on a remote host if the object
	files are only ever CALL'ed from COBOL and not CALL "LINK"'ed.
	The CODE-PREFIX option is only used on a CALL statement and is not
	used on a CALL "LINK".  Any Acucobol object files that are 
	CALL "LINK"'ed must be exist on a local (or NFS) filesystem.


	TECHNICAL NOTES
	===============

	NFS and Locking
	---------------
	The portion of NFS which causes the most significant performance
	problems is file and record locking.  The NFS locking daemon can
	be very slow.  Accessing a shared indexed file over NFS can cause
	many requests to the locking daemon.

	NOTE:	The WISP file open logic and the VSSUBS perform NO record 
		locking or file locking.  Thus using NFS for these functions
		in conjunction with AcuServer for COBOL I/O should not
		cause any performance problems.


	RVMAP Translation
	-----------------
	The RVMAP is used in the COBOL pre-open logic to generate the
	AcuServer file path.  After the unix file path is generated it is
	then checked against the prefixes in the RVMAP and if a match is
	found, a AcuServer file path is created by substituting the
	prefix.  The RVMAP translation is simply an exact text
	replacement, no syntax or validity checking is performed.  If the
	file prefixes are not unique it will use the first matching one it
	finds.  If no match is found then the AcuServer path will be the
	same as the unix path which is correct for local files.


	AcuServer with a Local file
	---------------------------
	It may happen that you need to be able to use AcuServer on a local
	file.  This presents a small challenge because the RVMAP will not
	know how to distinguish a AcuServer file from a local file since
	they are both local.  Here is one possible way of dealing with
	this scenario; create a symbolic link to the local file system
	thus giving it a prefix which you can use in RVMAP.

		$ mkdir /local			- machine name is "local"
		$ ln -s /disk1 /local/disk1

		LGMAP:
			VOL100 /disk1/vol100
			NEW100 /local/disk1/vol100

		RVMAP:
			/local/  @local:/ 

	VOLUME LIBRARY FILE	Standard UNIX file path
				AcuServer file path
	------ ------- ------   -----------------------------------
	VOL100 MYLIB   MYFILE	/disk1/vol100/mylib/myfile
				/disk1/vol100/mylib/myfile
				
	NEW100 MYLIB   MYFILE	/local/disk1/vol100/mylib/myfile
				@local:/disk1/vol100/mylib/myfile

	In the above example VOL100 and NEW100 actually point to the same
	location however NEW100 can be treated as a AcuServer volume.


	========================= END OF DOCUMENT ==========================
